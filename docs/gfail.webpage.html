
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" />
    <title>gfail.webpage &#8212; groundfailure 0.1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="gfail.utilities" href="gfail.utilities.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-gfail.webpage">
<span id="gfail-webpage"></span><h1>gfail.webpage<a class="headerlink" href="#module-gfail.webpage" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="gfail.webpage.hazdev">
<code class="sig-prename descclassname">gfail.webpage.</code><code class="sig-name descname">hazdev</code><span class="sig-paren">(</span><em class="sig-param">maplayerlist</em>, <em class="sig-param">configs</em>, <em class="sig-param">shakemap</em>, <em class="sig-param">outfolder=None</em>, <em class="sig-param">alpha=0.7</em>, <em class="sig-param">shakethreshtype='pga'</em>, <em class="sig-param">shakethresh=10.0</em>, <em class="sig-param">prefLS='Nowicki Jessee and others (2017)'</em>, <em class="sig-param">prefLQ='Zhu and others (2017)'</em>, <em class="sig-param">pop_file=None</em>, <em class="sig-param">defaultcolors=True</em>, <em class="sig-param">point=True</em>, <em class="sig-param">pager_alert=''</em>, <em class="sig-param">eventsource=''</em>, <em class="sig-param">eventsourcecode=''</em>, <em class="sig-param">createpngs=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gfail/webpage.html#hazdev"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gfail.webpage.hazdev" title="Permalink to this definition">¶</a></dt>
<dd><p>Create all files needed for product page creation
Assumes gfail has been run already with -w flag</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>maplayerlist</strong> (<em>list</em>) – List of model outputs from gfail.</p></li>
<li><p><strong>configs</strong> (<em>list</em>) – List of dictionaries of config files corresponding to
each model in maplayerlist and in the same order.</p></li>
<li><p><strong>shakemap</strong> (<em>str</em>) – path to shakemap .xml file.</p></li>
<li><p><strong>outfolder</strong> (<em>str</em>) – Location in which to save outputs. If None, will use
current directory.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Transparency to use for overlay pngs, value from 0 to 1.</p></li>
<li><p><strong>shakethreshtype</strong> (<em>str</em>) – Type of ground motion to use for shakethresh,
‘pga’, ‘pgv’, or ‘mmi’.</p></li>
<li><p><strong>shakethresh</strong> – Float or list of shaking thresholds in %g for pga, cm/s
for pgv, float for mmi. Used for Hagg and Exposure computation.</p></li>
<li><p><strong>prefLS</strong> (<em>str</em>) – shortref of “preferred” landslide model.</p></li>
<li><p><strong>prefLQ</strong> (<em>str</em>) – shortref of “preferred” liquefaction model.</p></li>
<li><p><strong>pop_filt</strong> (<em>str</em>) – file path to population file used to compute
population-based alert levels.</p></li>
<li><p><strong>defaultcolors</strong> (<em>bool</em>) – If True, will use DFCOLORS for all layers instead
of determining new ones. This will crash if any of the layers have
a different number of bins than the number of DFCOLORS</p></li>
<li><p><strong>point</strong> (<em>bool</em>) – if True, event is a point source and warning should be
displayed</p></li>
<li><p><strong>pager_alert</strong> (<em>str</em>) – PAGER alert level, e.g., ‘green’. ‘pending’, …</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Files that need to be sent to comcat for hazdev to create the product</dt><dd><dl class="simple">
<dt>webpage including:</dt><dd><ul class="simple">
<li><p>info.json</p></li>
<li><p>transparent png overlays of all models</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="gfail.webpage.create_png">
<code class="sig-prename descclassname">gfail.webpage.</code><code class="sig-name descname">create_png</code><span class="sig-paren">(</span><em class="sig-param">event_dir</em>, <em class="sig-param">lsmodels=None</em>, <em class="sig-param">lqmodels=None</em>, <em class="sig-param">mercator=True</em>, <em class="sig-param">lsmask=0.002</em>, <em class="sig-param">lqmask=0.005</em>, <em class="sig-param">legends=False</em>, <em class="sig-param">eventsource=''</em>, <em class="sig-param">eventsourcecode=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gfail/webpage.html#create_png"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gfail.webpage.create_png" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates transparent PNG file for website.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>event_dir</strong> (<em>srt</em>) – Directory containing ground failure results.</p></li>
<li><p><strong>lsmodels</strong> (<em>list</em>) – List of dictionaries of model summary info compiled
by the hazdev function. If not specified, code will search for
the hdf5 files for the preferred model and will create this
dictionary and will apply default colorbars and bins.</p></li>
<li><p><strong>lqmodels</strong> (<em>list</em>) – Same as above for liquefaction.</p></li>
<li><p><strong>mercator</strong> (<em>bool</em>) – Project raster to web mercator</p></li>
<li><p><strong>lsmask</strong> (<em>float</em>) – Mask all landslide cells with probabilities below this
threshold</p></li>
<li><p><strong>lqmask</strong> (<em>float</em>) – Mask all liquefaction cells with probabilities below
this threshold</p></li>
<li><p><strong>legends</strong> (<em>bool</em>) – if True, will produce png files of legends for each
preferred model</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>.png map overlays and .json files specifying their mapped extents</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="gfail.webpage.create_info">
<code class="sig-prename descclassname">gfail.webpage.</code><code class="sig-name descname">create_info</code><span class="sig-paren">(</span><em class="sig-param">event_dir</em>, <em class="sig-param">lsmodels</em>, <em class="sig-param">lqmodels</em>, <em class="sig-param">eventsource=''</em>, <em class="sig-param">eventsourcecode=''</em>, <em class="sig-param">point=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gfail/webpage.html#create_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gfail.webpage.create_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Create info.json for ground failure product.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>event_dir</strong> (<em>srt</em>) – Directory containing ground failure results.</p></li>
<li><p><strong>lsmodels</strong> (<em>list</em>) – List of dictionaries of model summary info compiled
by the hazdev function. If not specified, code will search for
the hdf5 files for the preferred model and will create this
dictionary and will apply default colorbars and bins.</p></li>
<li><p><strong>lqmodels</strong> (<em>list</em>) – Same as above for liquefaction.</p></li>
<li><p><strong>point</strong> (<em>bool</em>) – if True, event is a point source and warning should be
displayed</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>creates info.json for this event</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="gfail.webpage.make_legends">
<code class="sig-prename descclassname">gfail.webpage.</code><code class="sig-name descname">make_legends</code><span class="sig-paren">(</span><em class="sig-param">lqmin=0.005</em>, <em class="sig-param">lsmin=0.002</em>, <em class="sig-param">outfolder=None</em>, <em class="sig-param">orientation='horizontal'</em>, <em class="sig-param">transparent=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gfail/webpage.html#make_legends"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gfail.webpage.make_legends" title="Permalink to this definition">¶</a></dt>
<dd><p>Make png file of legends to go with pngs using DFCOLORS and DFBINS</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lqmin</strong> (<em>float</em>) – minimum visible value of liquefaction probability</p></li>
<li><p><strong>lsmin</strong> (<em>float</em>) – same as above for landslides</p></li>
<li><p><strong>outfolder</strong> (<em>float</em>) – folder to place pngs of legends</p></li>
<li><p><strong>orientation</strong> (<em>str</em>) – orientation of colorbar, ‘horizontal’ or ‘vertical’</p></li>
<li><p><strong>transparent</strong> (<em>bool</em>) – if True, background will be transparent</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(lsfilename, lqfilename), locations of files that were created.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="gfail.webpage.create_kmz">
<code class="sig-prename descclassname">gfail.webpage.</code><code class="sig-name descname">create_kmz</code><span class="sig-paren">(</span><em class="sig-param">maplayer</em>, <em class="sig-param">outfile</em>, <em class="sig-param">mask=None</em>, <em class="sig-param">levels=None</em>, <em class="sig-param">colorlist=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gfail/webpage.html#create_kmz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gfail.webpage.create_kmz" title="Permalink to this definition">¶</a></dt>
<dd><p>Create kmz files of models</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>maplayer</strong> (<em>dict</em>) – <p>Dictionary of one model result formatted like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;grid&#39;</span><span class="p">:</span> <span class="n">mapio</span> <span class="n">grid2D</span> <span class="nb">object</span><span class="p">,</span>
    <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;label for colorbar and top line of subtitle&#39;</span><span class="p">,</span>
    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;output or input to model&#39;</span><span class="p">,</span>
    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;description for subtitle&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
</p></li>
<li><p><strong>outfile</strong> (<em>str</em>) – File extension</p></li>
<li><p><strong>mask</strong> (<em>float</em>) – make all cells below this value transparent</p></li>
<li><p><strong>levels</strong> (<em>array</em>) – list of bin edges for each color, must be same length</p></li>
<li><p><strong>colorlist</strong> (<em>array</em>) – list of colors for each bin, should be length one less than levels</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>kmz file</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="gfail.webpage.get_zoomextent">
<code class="sig-prename descclassname">gfail.webpage.</code><code class="sig-name descname">get_zoomextent</code><span class="sig-paren">(</span><em class="sig-param">grid</em>, <em class="sig-param">propofmax=0.3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gfail/webpage.html#get_zoomextent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gfail.webpage.get_zoomextent" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the extent that contains all values with probabilities exceeding
a threshold in order to determine ideal zoom level for interactive map
If nothing is above the threshold, uses the full extent</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid</strong> – grid2d of model output</p></li>
<li><p><strong>propofmax</strong> (<em>float</em>) – Proportion of maximum that should be fully included
within the bounds.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>a dictionary with keys ‘xmin’, ‘xmax’, ‘ymin’, and</dt><dd><p>’ymax’ that defines the zoomed boundaries in geographic coordinates.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>boundaries</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="gfail.webpage.make_rgba">
<code class="sig-prename descclassname">gfail.webpage.</code><code class="sig-name descname">make_rgba</code><span class="sig-paren">(</span><em class="sig-param">grid2D</em>, <em class="sig-param">levels</em>, <em class="sig-param">colorlist</em>, <em class="sig-param">mask=None</em>, <em class="sig-param">mercator=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gfail/webpage.html#make_rgba"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gfail.webpage.make_rgba" title="Permalink to this definition">¶</a></dt>
<dd><p>Make an rgba (red, green, blue, alpha) grid out of raw data values and
provide extent and limits needed to save as an image file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid2D</strong> – Mapio Grid2D object of result to mape</p></li>
<li><p><strong>levels</strong> (<em>array</em>) – list of bin edges for each color, must be same length</p></li>
<li><p><strong>colorlist</strong> (<em>array</em>) – list of colors for each bin, should be length one
less than levels</p></li>
<li><p><strong>mask</strong> (<em>float</em>) – mask all values below this value</p></li>
<li><p><strong>mercator</strong> (<em>bool</em>) – project to web mercator (needed for leaflet, not
for kmz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(rgba_img, extent, lmin, lmax, cmap), where:</dt><dd><ul class="simple">
<li><p>rgba_img: rgba (red green blue alpha) image</p></li>
<li><dl class="simple">
<dt>extent: list of outside corners of image,</dt><dd><p>[minlat, maxlat, minlon, maxlon]</p>
</dd>
</dl>
</li>
<li><p>lmin: lowest bin edge</p></li>
<li><p>lmax: highest bin edge</p></li>
<li><p>cmap: colormap corresponding to image</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="gfail.webpage.make_legend">
<code class="sig-prename descclassname">gfail.webpage.</code><code class="sig-name descname">make_legend</code><span class="sig-paren">(</span><em class="sig-param">levels</em>, <em class="sig-param">colorlist</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">orientation='horizontal'</em>, <em class="sig-param">title=None</em>, <em class="sig-param">transparent=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gfail/webpage.html#make_legend"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gfail.webpage.make_legend" title="Permalink to this definition">¶</a></dt>
<dd><p>Make legend file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>levels</strong> (<em>array</em>) – list of bin edges for each color, must be same length</p></li>
<li><p><strong>colorlist</strong> (<em>array</em>) – list of colors for each bin, should be length one
less than levels</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – File extension of legend file</p></li>
<li><p><strong>orientation</strong> (<em>str</em>) – orientation of colorbar, ‘horizontal’ or ‘vertical’</p></li>
<li><p><strong>title</strong> (<em>str</em>) – title of legend (usually units)</p></li>
<li><p><strong>transparent</strong> (<em>bool</em>) – if True, background will be transparent</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>figure of legend</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="gfail.webpage.setupcolors">
<code class="sig-prename descclassname">gfail.webpage.</code><code class="sig-name descname">setupcolors</code><span class="sig-paren">(</span><em class="sig-param">sync</em>, <em class="sig-param">plotorder</em>, <em class="sig-param">lims</em>, <em class="sig-param">colormaps</em>, <em class="sig-param">defaultcolormap=&lt;matplotlib.colors.LinearSegmentedColormap object&gt;</em>, <em class="sig-param">logscale=None</em>, <em class="sig-param">alpha=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gfail/webpage.html#setupcolors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gfail.webpage.setupcolors" title="Permalink to this definition">¶</a></dt>
<dd><p>Get colors that will be used for all colorbars from reference grid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sync</strong> (<em>str</em>) – If False, will exit program, else corresponds to the shortref
of the model which should serve as the template for
the colorbars used by all other models. All other models must
have the exact same number of bins</p></li>
<li><p><strong>plotorder</strong> (<em>list</em>) – List of keys of shortrefs of the grids that will be
plotted.</p></li>
<li><p><strong>lims</strong> – <p>Nx1 list of tuples or numpy arrays corresponding to
plotorder defining the bin edges to use for each model.
Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">15</span><span class="p">)]</span>
</pre></div>
</div>
</p></li>
<li><p><strong>colormaps</strong> (<em>list</em>) – List of strings of matplotlib colormaps (e.g.
cm.autumn_r) corresponding to plotorder</p></li>
<li><p><strong>defaultcolormap</strong> (<em>matplotlib colormap</em>) – Colormap to use if
colormaps is not defined. default cm.CMRmap_r</p></li>
<li><p><strong>logscale</strong> – If not None, then a list of booleans corresponding to
plotorder stating whether to use log scaling in determining colors</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(sync, colorlist, lim1) where:</dt><dd><ul class="simple">
<li><p>sync (bool): whether or not colorbars are/can be synced</p></li>
<li><dl class="simple">
<dt>colorlist (list): list of rgba colors that will be applied to all</dt><dd><p>models regardless of bin edge values</p>
</dd>
</dl>
</li>
<li><p>lim1 (array): bin edges of model to which others are synced</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">groundfailure</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="gfail.html">gfail</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="gfail.conf.html">gfail.conf</a></li>
<li class="toctree-l2"><a class="reference internal" href="gfail.gfailrun.html">gfail.gfailrun</a></li>
<li class="toctree-l2"><a class="reference internal" href="gfail.godt.html">gfail.godt</a></li>
<li class="toctree-l2"><a class="reference internal" href="gfail.logisticmodel.html">gfail.logisticmodel</a></li>
<li class="toctree-l2"><a class="reference internal" href="gfail.pdl.html">gfail.pdl</a></li>
<li class="toctree-l2"><a class="reference internal" href="gfail.spatial.html">gfail.spatial</a></li>
<li class="toctree-l2"><a class="reference internal" href="gfail.stats.html">gfail.stats</a></li>
<li class="toctree-l2"><a class="reference internal" href="gfail.temphdf.html">gfail.temphdf</a></li>
<li class="toctree-l2"><a class="reference internal" href="gfail.transfer.html">gfail.transfer</a></li>
<li class="toctree-l2"><a class="reference internal" href="gfail.utilities.html">gfail.utilities</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">gfail.webpage</a></li>
</ul>
</li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      
      
    </div>

    

    
  </body>
</html>